'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,d,g){b instanceof String&&(b=String(b));for(var k=b.length,h=0;h<k;h++){var l=b[h];if(d.call(g,l,h,b))return{i:h,v:l}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,g){b!=Array.prototype&&b!=Object.prototype&&(b[d]=g.value)};$jscomp.getGlobal=function(b){b=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var d=0;d<b.length;++d){var g=b[d];if(g&&g.Math==Math)return g}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,d,g,k){if(d){g=$jscomp.global;b=b.split(".");for(k=0;k<b.length-1;k++){var h=b[k];h in g||(g[h]={});g=g[h]}b=b[b.length-1];k=g[b];d=d(k);d!=k&&null!=d&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6","es3");
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],b):b(CodeMirror)})(function(b){function d(a,c){"string"==typeof a?a=new RegExp(a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c?"gi":"g"):a.global||(a=new RegExp(a.source,a.ignoreCase?"gi":"g"));return{token:function(c){a.lastIndex=c.pos;
var b=a.exec(c.string);if(b&&b.index==c.pos)return c.pos+=b[0].length||1,"searching";b?c.pos=b.index:c.skipToEnd()}}}function g(){this.overlay=this.posFrom=this.posTo=this.lastQuery=this.query=null}function k(a){return a.state.search||(a.state.search=new g)}function h(a){return"string"==typeof a&&a==a.toLowerCase()}function l(a,c,b){return a.getSearchCursor(c,b,{caseFold:h(c),multiline:!0})}function z(a,c,b,f,e){a.openDialog(c,f,{value:b,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){n(a)},
onKeyDown:e})}function r(a,c,b,f,e){a.openDialog?a.openDialog(c,e,{value:f,selectValueOnOpen:!0}):e(prompt(b,f))}function A(a,c,b,f){if(a.openConfirm)a.openConfirm(c,f);else if(confirm(b))f[0]()}function u(a){return a.replace(/\\([nrt\\])/g,function(a,b){return"n"==b?"\n":"r"==b?"\r":"t"==b?"\t":"\\"==b?"\\":a})}function v(a){var b=a.match(/^\/(.*)\/([a-z]*)$/);if(b)try{a=new RegExp(b[1],-1==b[2].indexOf("i")?"":"i")}catch(C){}else a=u(a);if("string"==typeof a?""==a:a.test(""))a=/x^/;return a}function p(a,
b,g){b.queryText=g;b.query=v(g);a.removeOverlay(b.overlay,h(b.query));b.overlay=d(b.query,h(b.query));a.addOverlay(b.overlay);a.showMatchesOnScrollbar&&(b.annotate&&(b.annotate.clear(),b.annotate=null),b.annotate=a.showMatchesOnScrollbar(b.query,h(b.query)))}function m(a,c,g,f){var e=k(a);if(e.query)return q(a,c);var d=a.getSelection()||e.lastQuery;d instanceof RegExp&&"x^"==d.source&&(d=null);if(g&&a.openDialog){var t=null,h=function(c,f){b.e_stop(f);c&&(c!=e.queryText&&(p(a,e,c),e.posFrom=e.posTo=
a.getCursor()),t&&(t.style.opacity=1),q(a,f.shiftKey,function(b,c){var e;3>c.line&&document.querySelector&&(e=a.display.wrapper.querySelector(".CodeMirror-dialog"))&&e.getBoundingClientRect().bottom-4>a.cursorCoords(c,"window").top&&((t=e).style.opacity=.4)}))};z(a,w(a),d,h,function(c,e){var f=b.keyName(c),d=a.getOption("extraKeys");f=d&&d[f]||b.keyMap[a.getOption("keyMap")][f];if("findNext"==f||"findPrev"==f||"findPersistentNext"==f||"findPersistentPrev"==f)b.e_stop(c),p(a,k(a),e),a.execCommand(f);
else if("find"==f||"findPersistent"==f)b.e_stop(c),h(e,c)});f&&d&&(p(a,e,d),q(a,c))}else r(a,w(a),"Search for:",d,function(b){b&&!e.query&&a.operation(function(){p(a,e,b);e.posFrom=e.posTo=a.getCursor();q(a,c)})})}function q(a,c,d){a.operation(function(){var f=k(a),e=l(a,f.query,c?f.posFrom:f.posTo);if(!e.find(c)&&(e=l(a,f.query,c?b.Pos(a.lastLine()):b.Pos(a.firstLine(),0)),!e.find(c)))return;a.setSelection(e.from(),e.to());a.scrollIntoView({from:e.from(),to:e.to()},20);f.posFrom=e.from();f.posTo=
e.to();d&&d(e.from(),e.to())})}function n(a){a.operation(function(){var b=k(a);if(b.lastQuery=b.query)b.query=b.queryText=null,a.removeOverlay(b.overlay),b.annotate&&(b.annotate.clear(),b.annotate=null)})}function w(a){return'<span class="CodeMirror-search-label">'+a.phrase("Search:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+a.phrase("(Use /re/ syntax for regexp search)")+"</span>"}function B(a){return'<span class="CodeMirror-search-label">'+
a.phrase("Replace?")+"</span> <button>"+a.phrase("Yes")+"</button> <button>"+a.phrase("No")+"</button> <button>"+a.phrase("All")+"</button> <button>"+a.phrase("Stop")+"</button> "}function x(a,b,d){a.operation(function(){for(var c=l(a,b);c.findNext();)if("string"!=typeof b){var e=a.getRange(c.from(),c.to()).match(b);c.replace(d.replace(/\$(\d)/g,function(a,b){return e[b]}))}else c.replace(d)})}function y(a,b){if(!a.getOption("readOnly")){var c=a.getSelection()||k(a).lastQuery,d='<span class="CodeMirror-search-label">'+
(b?a.phrase("Replace all:"):a.phrase("Replace:"))+"</span>";r(a,d+(' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+a.phrase("(Use /re/ syntax for regexp search)")+"</span>"),d,c,function(c){c&&(c=v(c),r(a,'<span class="CodeMirror-search-label">'+a.phrase("With:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',a.phrase("Replace with:"),"",function(e){e=u(e);if(b)x(a,c,e);else{n(a);
var d=l(a,c,a.getCursor("from")),f=function(){var b=d.from(),h;if(!(h=d.findNext())&&(d=l(a,c),!(h=d.findNext())||b&&d.from().line==b.line&&d.from().ch==b.ch))return;a.setSelection(d.from(),d.to());a.scrollIntoView({from:d.from(),to:d.to()});A(a,B(a),a.phrase("Replace?"),[function(){g(h)},f,function(){x(a,c,e)}])},g=function(a){d.replace("string"==typeof c?e:e.replace(/\$(\d)/g,function(b,c){return a[c]}));f()};f()}}))})}}b.commands.find=function(a){n(a);m(a)};b.commands.findPersistent=function(a){n(a);
m(a,!1,!0)};b.commands.findPersistentNext=function(a){m(a,!1,!0,!0)};b.commands.findPersistentPrev=function(a){m(a,!0,!0,!0)};b.commands.findNext=m;b.commands.findPrev=function(a){m(a,!0)};b.commands.clearSearch=n;b.commands.replace=y;b.commands.replaceAll=function(a){y(a,!0)}});
